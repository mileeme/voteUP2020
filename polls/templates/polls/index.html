{% extends 'base.html' %}
{% block title %}2020 Candidate Info{% endblock %}
{% block body %}


<!-- poll -->
{% for election in election_list %}
<div class="container">
    <h1>{{ election.name }}</h1>
    {% if election.description %}
        {{ election.description|safe }}
    {% endif %}
</div>

<!-- get questions -->
<div class="container">
    {% for question in question_list %}
    <div id="poll">
        <!-- question -->
        <h3 id="question" data-id="{{ question.number }}">{{ question|safe }}</h3>
        {% for response in response_list %}
        {% if question.number == response.response_id %}

        <!-- response -->
        <span id="candidateResponse" class="candidate-response" value="{{ response.response|safe }}" data-response="{{ response.response_id }}" data-candidate="{{ response.candidate_id }}">{{ response.response|safe }}</span>
        {% endif %}
        {% endfor %}

        <!-- detail -->
        {% for response in response_list %}
        {% if question.number == response.response_id %}
        <div id="responseDetail" class="u-hide" data-response="{{ response.response_id }}"
                data-candidate="{{ response.candidate_id }}">
            <p>{{ response.description|safe }}</p>
        </div>
        {% endif %}
        {% endfor %}
    </div>
    {% endfor %}
</div>

<!-- results button -->
<div id="pre-button"></div>
<button id="showResults" class="is-disabled-button">0 answered</button>


<div id="pollResults" class="u-hide">
    <!-- total tally -->
    <div class="container">
        <p>total questions answered: <span id="countAll"></span> out of <span id="candidateCounter">0</span></p>
        {% for candidate in candidate_list %}
        <p>From the questions, I have matched <span id="candidate{{ candidate.id }}">0</span> / My values are <span
                id="percentage{{ candidate.id }}">0</span>% compatible with {{ candidate.l_name }}</p>
        {% endfor %}
    </div>
    
    <!-- table of results -->
    <div class="container">
        <table>
            <thead>
                <th></th>
                {% for candidate in candidate_list %}
                {% if election.id == candidate.election_id %}
                <th>{{ candidate.f_name }} {{ candidate.l_name }}</th>
                {% endif %}
                {% endfor %}
            </thead>
            <tbody>
                {% for question in question_list %}
                <tr id="tableRow" data-question="{{ question.number }}">
                    <td>{{ question|safe }}</td>
                    {% for response in response_list %}
                    {% if question.number == response.response_id %}
                    <td id="tableColumn" class="" data-response="{{ response.response_id }}"
                        data-candidate="{{ response.candidate_id }}"><span ></span>
                    </td>
                    {% endif %}
                    {% endfor %}
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endfor %}

<!-- check registration -->
<div class="check-registration">
    <div class="registration-form">
        <form action="#">
            {% csrf_token %}
            <h2>Check my voter registration status</h2>

            <input type="text" placeholder="search your state abbreviation" autocomplete="off" onkeyup="searchStates()" id="registrationInput" class="registration-input">

            <ul id="registrationUL" style="height: 100px; overflow: hidden;">
                {% for registration in registration_list %}
                <li id="stateLink" class="u-hide" data-state="{{ registration.id }}"><a href="{{ registration.check_url }}" target="_blank" data-id="{{ registration.id }}">{{ registration.state_abbr }} ({{ registration.state }}) registration lookup</a></li>
                {% endfor %}
            </ul>
        </form>
    </div>
</div>

{% endblock %}